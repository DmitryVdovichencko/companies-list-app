(function(e){function t(t){for(var n,o,i=t[0],c=t[1],l=t[2],d=0,p=[];d<i.length;d++)o=i[d],Object.prototype.hasOwnProperty.call(r,o)&&r[o]&&p.push(r[o][0]),r[o]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);u&&u(t);while(p.length)p.shift()();return s.push.apply(s,l||[]),a()}function a(){for(var e,t=0;t<s.length;t++){for(var a=s[t],n=!0,i=1;i<a.length;i++){var c=a[i];0!==r[c]&&(n=!1)}n&&(s.splice(t--,1),e=o(o.s=a[0]))}return e}var n={},r={app:0},s=[];function o(t){if(n[t])return n[t].exports;var a=n[t]={i:t,l:!1,exports:{}};return e[t].call(a.exports,a,a.exports,o),a.l=!0,a.exports}o.m=e,o.c=n,o.d=function(e,t,a){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:a})},o.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(e,t){if(1&t&&(e=o(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(o.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)o.d(a,n,function(t){return e[t]}.bind(null,n));return a},o.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="/companies-list-app/";var i=window["webpackJsonp"]=window["webpackJsonp"]||[],c=i.push.bind(i);i.push=t,i=i.slice();for(var l=0;l<i.length;l++)t(i[l]);var u=c;s.push([0,"chunk-vendors"]),a()})({0:function(e,t,a){e.exports=a("56d7")},"0025":function(e,t,a){},"00ee":function(e,t,a){},2012:function(e,t,a){},"30db":function(e,t,a){"use strict";var n=a("0025"),r=a.n(n);r.a},"56d7":function(e,t,a){"use strict";a.r(t);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),r=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"small-container",attrs:{id:"app"}},[a("h1",[e._v("Список компаний")]),a("button",{staticClass:"add-button",on:{click:e.openModal}},[a("plus-circle-icon",{staticClass:"add-button__icon",attrs:{size:"1.5x"}}),e._v(" "),a("span",{staticClass:"add-button__text"},[e._v("Добавить")])],1),a("modal",{directives:[{name:"show",rawName:"v-show",value:e.isModalOpen,expression:"isModalOpen"}],on:{close:e.closeModal},scopedSlots:e._u([{key:"body",fn:function(){return[a("company-form",{on:{"add:company":e.addCompany}})]},proxy:!0}])}),a("companies-table",{attrs:{companies:e.companies},on:{"delete:company":e.deleteCompany,"edit:company":e.editCompany}})],1)},s=[],o=(a("a4d3"),a("99af"),a("4de4"),a("4160"),a("d81d"),a("e439"),a("dbb4"),a("b64b"),a("159b"),a("284c")),i=a("2fa7"),c=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"company-form",attrs:{id:"company-form"}},[a("form",{on:{submit:function(t){return t.preventDefault(),e.handleSubmit(t)}}},[a("div",{staticClass:"company-form__data"},e._l(e.company,(function(t){return a("div",{key:t.key,staticClass:"company-form__item",class:t.key},[a("div",{staticClass:"flex-column"},[a("label",[e._v(e._s(t.label))]),a("input",{directives:[{name:"model",rawName:"v-model",value:t.value,expression:"field.value"}],class:{"has-error":e.submitting&&t.error},attrs:{type:"text"},domProps:{value:t.value},on:{focus:e.clearStatus,keypress:e.clearStatus,input:function(a){a.target.composing||e.$set(t,"value",a.target.value)}}})])])})),0),e.error&&e.loading?a("p",{staticClass:"error-message"},[a("alert-triangle-icon",{staticClass:"error-icon",attrs:{size:"1.5x"}}),e._v(" "+e._s(e.errorMessage)+" ")],1):e._e(),e.error&&e.submitting?a("p",{staticClass:"error-message"},[a("alert-triangle-icon",{staticClass:"error-icon",attrs:{size:"1.5x"}}),e._v(" "+e._s(e.errorMessage)+" ")],1):e._e(),e.success?a("p",{staticClass:"success-message"},[a("check-square-icon",{staticClass:"success-icon",attrs:{size:"1.5x"}}),e._v(" Компания успешно добавлена ")],1):e._e()]),a("div",{staticClass:"flex-row company-form__actions"},[a("button",{on:{click:function(t){return e.getData(e.company.inn.value)}}},[a("div",{staticClass:"flex-row load-button"},[a("download-cloud-icon",{staticClass:"load-button__icon",attrs:{size:"1.5x"}}),a("span",{staticClass:"load-button__text"},[e._v("Загрузить данные компании по ИНН")])],1)]),a("button",{staticClass:"add-button",on:{click:e.handleSubmit}},[e._v("Добавить компанию")])])])},l=[],u=(a("0d03"),a("b0c0"),a("d3b7"),a("07ac"),a("96cf"),a("89ba")),d=a("0a35"),p={name:"company-form",components:{CheckSquareIcon:d["b"],AlertTriangleIcon:d["a"],DownloadCloudIcon:d["c"]},data:function(){return{company:{name:{key:"name",label:"Название компании",value:"",error:!1},address:{key:"address",label:"Адрес",value:"",error:!1},ogrn:{key:"ogrn",label:"ОГРН",value:"",error:!1},inn:{key:"inn",label:"ИНН",value:"",error:!1},regDate:{key:"regDate",label:"Дата регистрации",value:"",error:!1}},submitting:!1,loading:!1,error:!1,errorMessage:"",success:!1}},computed:{isSomeEmpty:function(){Object.values(this.company).forEach((function(e){e.error=""===e.value}));var e=Object.values(this.company).filter((function(e){return""===e.value}));return 0!==e.length},validate:function(){var e={empty:"Пожалуйста заполните все необходимые поля"};return this.isSomeEmpty?{error:!0,message:e.empty}:{error:!1,message:""}}},methods:{handleSubmit:function(){var e=this;if(this.submitting=!0,this.clearStatus(),this.validate.error)return this.error=!0,void(this.errorMessage=this.validate.message);this.$emit("add:company",this.company),this.error=!1,this.success=!0,this.submitting=!1,this.success&&setTimeout((function(){e.clearInputs()}),5e3)},getData:function(){var e=Object(u["a"])(regeneratorRuntime.mark((function e(t){var a,n,r,s,o,i,c,l,u,d;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return this.loading=!0,a="6034ce553132e1c3f7a02bb7a15337d46f941b1a",n="https://suggestions.dadata.ru/suggestions/api/4_1/rs/findById/party",r={query:t},s={method:"POST",headers:{"Content-Type":"application/json;charset=utf-8",Authorization:"Token "+a},body:JSON.stringify(r)},e.next=7,fetch(n,s);case 7:if(o=e.sent,o.ok){e.next=14;break}return this.clearInputs(),this.loading=!0,this.error=!0,this.errorMessage="Ошибка соединения с сервером dadata.ru. Попробуйте ввести данные вручную",e.abrupt("return");case 14:return e.next=16,o.json();case 16:return i=e.sent,e.next=19,i.suggestions[0];case 19:if(c=e.sent,void 0!==c){e.next=28;break}return this.clearInputs(),this.loading=!0,this.error=!0,this.errorMessage="Компания с введенным ИНН не найдена",e.abrupt("return");case 28:this.error=!1,this.errorMessage="";case 29:return l={year:"numeric",month:"numeric",day:"numeric"},e.next=32,new Date(c.data.ogrn_date).toLocaleString("ru-RU",l);case 32:return u=e.sent,e.next=35,{company:{name:{key:"name",label:"Название компании",value:c.data.name.short_with_opf,error:!1},address:{key:"address",label:"Адрес",value:c.data.address.value,error:!1},ogrn:{key:"ogrn",label:"ОГРН",value:c.data.ogrn,error:!1},inn:{key:"inn",label:"ИНН",value:c.data.inn,error:!1},regDate:{key:"regDate",label:"Дата регистрации",value:u,error:!1}}};case 35:d=e.sent,console.log(d),Object.assign(this.$data,d),this.loading=!1;case 39:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}(),clearInputs:function(){Object.assign(this.$data,this.$options.data.apply(this))},clearStatus:function(){this.success=!1,this.error=!1}}},m=p,v=(a("64be"),a("2877")),f=Object(v["a"])(m,c,l,!1,null,"1e519af3",null),h=f.exports,g=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{attrs:{id:"companies-table"}},[a("table",[e._m(0),a("tbody",e._l(e.companies,(function(t){return a("tr",{key:t.id},[e.editing===t.id?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.name.value,expression:"company.name.value"}],class:{"has-error":e.editing&&""===t.name.value},attrs:{type:"text"},domProps:{value:t.name.value},on:{input:function(a){a.target.composing||e.$set(t.name,"value",a.target.value)}}})]):a("td",[e._v(e._s(t.name.value))]),e.editing===t.id?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.address.value,expression:"company.address.value"}],class:{"has-error":e.editing&&""===t.address.value},attrs:{type:"text"},domProps:{value:t.address.value},on:{input:function(a){a.target.composing||e.$set(t.address,"value",a.target.value)}}})]):a("td",[e._v(e._s(t.address.value))]),e.editing===t.id?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.ogrn.value,expression:"company.ogrn.value"}],class:{"has-error":e.editing&&""===t.ogrn.value},attrs:{type:"text"},domProps:{value:t.ogrn.value},on:{input:function(a){a.target.composing||e.$set(t.ogrn,"value",a.target.value)}}})]):a("td",[e._v(e._s(t.ogrn.value))]),e.editing===t.id?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.inn.value,expression:"company.inn.value"}],class:{"has-error":e.editing&&""===t.inn.value},attrs:{type:"text"},domProps:{value:t.inn.value},on:{input:function(a){a.target.composing||e.$set(t.inn,"value",a.target.value)}}})]):a("td",[e._v(e._s(t.inn.value))]),e.editing===t.id?a("td",[a("input",{directives:[{name:"model",rawName:"v-model",value:t.regDate.value,expression:"company.regDate.value"}],class:{"has-error":e.editing&&""===t.regDate.value},attrs:{type:"text"},domProps:{value:t.regDate.value},on:{input:function(a){a.target.composing||e.$set(t.regDate,"value",a.target.value)}}})]):a("td",[e._v(e._s(t.regDate.value))]),e.editing===t.id?a("td",[a("div",{staticClass:"flex-row action"},[a("button",{staticClass:"action-button",attrs:{title:"Сохранить"},on:{click:function(a){return e.editCompany(t)}}},[a("save-icon",{staticClass:"icon",attrs:{size:"1.5x"}})],1),a("button",{staticClass:"action-button",attrs:{title:"Отменить"},on:{click:function(a){return e.cancelEditing(t)}}},[a("rotate-ccw-icon",{staticClass:"icon",attrs:{size:"1.5x"}})],1)])]):a("td",[a("div",{staticClass:"flex-row action"},[a("button",{staticClass:"action-button edit",attrs:{title:"Изменить"},on:{click:function(a){return e.editMode(t)}}},[a("edit-icon",{staticClass:"action-button__icon",attrs:{size:"1.5x"}})],1),a("button",{staticClass:"action-button error",attrs:{title:"Удалить"},on:{click:function(a){return e.$emit("delete:company",t.id)}}},[a("trash-2-icon",{staticClass:"icon",attrs:{size:"1.5x"}})],1)])])])})),0)])])},b=[function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("thead",[a("tr",[a("th",{staticClass:"name"},[e._v("Наименование")]),a("th",{staticClass:"address"},[e._v("Адрес")]),a("th",{staticClass:"ogrn"},[e._v("ОГРН")]),a("th",{staticClass:"inn"},[e._v("ИНН")]),a("th",{staticClass:"regDate"},[e._v("Дата регистрации")]),a("th",{staticClass:"actions"},[e._v("Действия")])])])}],y=(a("45fc"),{name:"companies-table",components:{EditIcon:d["d"],Trash2Icon:d["h"],SaveIcon:d["g"],RotateCcwIcon:d["f"]},data:function(){return{editing:null,error:!1,savedCompany:null}},methods:{editMode:function(e){this.editing=e.id,this.savedCompany=JSON.parse(JSON.stringify(e))},isEmpty:function(e){return Object.values(e).some((function(e){return""===e.value}))},cancelEditing:function(e){this.$emit("edit:company",e.id,this.savedCompany),this.editing=null},editCompany:function(e){this.isEmpty(e)||(this.$emit("edit:company",e.id,e),this.editing=null)}},props:{companies:Array}}),_=y,C=(a("c3ce"),Object(v["a"])(_,g,b,!1,null,"178cb01e",null)),x=C.exports,O=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"modal-backdrop"},[a("div",{staticClass:"modal"},[e._t("header",[a("header",{staticClass:"modal__header"},[a("h2",[e._v("Добавить новую компанию")]),a("x-square-icon",{staticClass:"modal__close",attrs:{size:"1.5x"},on:{click:e.close}})],1)]),e._t("body"),e._t("footer")],2)])},w=[],k={name:"modal",components:{XSquareIcon:d["i"]},methods:{close:function(){this.$emit("close")}}},j=k,S=(a("30db"),Object(v["a"])(j,O,w,!1,null,null,null)),M=S.exports;function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function D(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(a,!0).forEach((function(t){Object(i["a"])(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(a).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var $={name:"app",components:{CompaniesTable:x,CompanyForm:h,Modal:M,PlusCircleIcon:d["e"]},data:function(){return{companies:[],isModalOpen:!1}},methods:{addCompany:function(e){var t=this.companies.length>0?this.companies[this.companies.length-1].id:0,a=t+1,n=D({},e,{id:a});this.companies=[].concat(Object(o["a"])(this.companies),[n])},editCompany:function(e,t){this.companies=this.companies.map((function(a){return a.id===e?t:a}))},deleteCompany:function(e){this.companies=this.companies.filter((function(t){return t.id!==e}))},openModal:function(){this.isModalOpen=!0},closeModal:function(){this.isModalOpen=!1}}},E=$,I=(a("5c0b"),Object(v["a"])(E,r,s,!1,null,null,null)),z=I.exports;n["a"].config.productionTip=!1,new n["a"]({render:function(e){return e(z)}}).$mount("#app")},"5c0b":function(e,t,a){"use strict";var n=a("9c0c"),r=a.n(n);r.a},"64be":function(e,t,a){"use strict";var n=a("00ee"),r=a.n(n);r.a},"9c0c":function(e,t,a){},c3ce:function(e,t,a){"use strict";var n=a("2012"),r=a.n(n);r.a}});
//# sourceMappingURL=app.c3f76252.js.map